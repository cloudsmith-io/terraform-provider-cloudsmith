# Vulnerability Policy Resource

The vulnerability policy resource allows for creation and management of vulnerability policies within a Cloudsmith organization.

See [help.cloudsmith.io](https://help.cloudsmith.io/docs/vulnerability-policy) for the full vulnerability policies documentation.

## Example Usage

```hcl
provider "cloudsmith" {
    api_key = "my-api-key"
}

data "cloudsmith_organization" "my_organization" {
    slug = "my-organization"
}

resource "cloudsmith_vulnerability_policy" "my_vulnerability_policy" {
    name                    = "My Policy"
    description             = "My vulnerability policy"
    min_severity            = "Medium"
    on_violation_quarantine = true
    allow_unknown_severity  = false
    package_query_string    = "format:python AND downloads:>50" 
    organization            = "my-organization"
}
```

## Argument Reference

The following arguments are supported:

* `organization` - (Required) Organization to which the policy belongs.
* `name` - (Required) The name of the vulnerability policy.
* `description` - (Optional) The description of the vulnerability policy.
* `min_severity` - (Optional) The minimum severity level where a policy violation will be flagged.
* `on_violation_quarantine` - (Optional) On violation of the vulnerability policy, quarantine violating packages.
* `allow_unknown_severity` - (Optional) Allow an unknown severity level.
* `package_query_string` - (Optional) A search / filter string of packages to include in the policy.

## Import

This resource can be imported using the organization slug and the vulnerability policy slug_perm.

```shell
terraform import cloudsmith_vulnerability_policy.my_policy my-organization
```
