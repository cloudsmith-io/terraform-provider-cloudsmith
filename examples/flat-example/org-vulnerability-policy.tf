resource "cloudsmith_vulnerability_policy" "python_policy" {
  name                    = "Python policy"
  description             = "Python block policy"
  min_severity            = "High"
  on_violation_quarantine = true
  allow_unknown_severity  = false
  package_query_string    = "format:python"
  organization            = data.cloudsmith_organization.org-demo.slug
}

resource "cloudsmith_vulnerability_policy" "container-policy-test" {
  name                    = "Container policy test"
  description             = "Container block policy test"
  min_severity            = "High"
  on_violation_quarantine = true
  allow_unknown_severity  = true
  package_query_string    = "format:docker and repository:shared-proxy-test"
  organization            = data.cloudsmith_organization.org-demo.slug
}


resource "cloudsmith_vulnerability_policy" "maven-policy" {
  name                    = "Maven policy"
  description             = "Maven block policy"
  min_severity            = "High"
  on_violation_quarantine = true
  allow_unknown_severity  = true
  package_query_string    = "format:maven"
  organization            = data.cloudsmith_organization.org-demo.slug
}


resource "cloudsmith_vulnerability_policy" "nuget-policy" {
  name                    = "Nuget policy"
  description             = "Nuget block policy"
  min_severity            = "High"
  on_violation_quarantine = true
  allow_unknown_severity  = true
  package_query_string    = "format:nuget"
  organization            = data.cloudsmith_organization.org-demo.slug
}


resource "cloudsmith_vulnerability_policy" "npm-policy" {
  name                    = "npm policy"
  description             = "npm block policy"
  min_severity            = "High"
  on_violation_quarantine = true
  allow_unknown_severity  = true
  package_query_string    = "format:npm"
  organization            = data.cloudsmith_organization.org-demo.slug
}
